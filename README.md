# Делегат

Обучающий проект. Был создан для объяснения студентам младших курсов принципов работы объектно-ориентированных указателей на функции-члены.

**Проект находится в разработке.**

## Сборка

Проект написан в Vsual Studio 2022 под Windows (конфигурации Debug и Release настроены только для платформы x64), но также есть возможность собрать его с помощью CMake под Linux или Windows. Как обычно, в директории с файлом `CMakeLists.txt`:

    mkdir build
    cd build
    cmake ..
    cmake --build .
    
Отладочная сборка (задана по умолчанию) будет выводить много полезной информации о типах, поэтому лучше использовать именно её, но можно пересобрать и релизную версию, под Linux:

    cmake -DCMAKE_BUILD_TYPE=Release ..
    cmake --build . --clean-first
    
Пересборка, но уже релизной версии, с помощью CMake под Windows:

    cmake --build . --target clean
    cmake --build . --config=Release

При очистке опцию `--config=Debug` в этом случае указывать не нужно, потому что в файле `CMakeLists.txt` отладочная сборка задана по умолчанию.

Изначально проект разрабатывался под стандарт `C++11`, но потом требование поддерживать этот стадарт было снято и дальнейшая разработка велась уже под **стандарт `C++14`**, поэтому в коде можно найти директивы препроцессора вида:

    #if __cplusplus < 201402L
    
***Код под этими директивами работает, он не мёртвый***, регулярно проверяется, потому что полезный в обучающих целях. Однако, сборка возможна только при поддержке компилятором стандарта `C++14`.

## Описание

Из Википедии:

> Делегат (англ. delegate) — класс, который позволяет хранить в себе ссылку на метод с определённой сигнатурой (порядком и типами принимаемых и типом возвращаемого значений) произвольного класса.

Именно это и было реализовано. Сам **делегат не является шаблоном**, для хранения в нём любых методов любых классов, инкапсулированных в шаблонном классе `Callback`, а также их вызова используется обобщённый интерфейс `ICallback`. Для передачи в хранимый метод аргументов, инкапсулированных, в свою очередь, в шаблонном классе `Arguments`, при его вызове используется, опять-таки, обобщённый интерфейс `IArguments`.

Передача аргументов реализована двумя способами: по значению и по ссылке (rvalue и lvalue). Второй способом приведён для примера и работает лишь в некоторых случаях, поэтому убран под макрос `PERFECT_FORWARDING`. Он является самым оптимальным при вызове функции "прямо здесь и сейчас", но, к сожалению, нереализуемым в рамках поставленных условий. В функции `main()` есть специальные примеры для этого способа, **рекомендуется собрать проект с указанным макросом и разобрать убранный под него код**.
